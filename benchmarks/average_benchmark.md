# Average MLX benchmark

Averaged runtime benchmark of mlx operations, measured in `milliseconds`.

* `mlx_gpu`: mlx framework with gpu backend
* `mlx_cpu`: mlx framework with cpu backend
* `cpu`: torch framework with cpu backend
* `mps`: torch framework with mps (gpu) backend
* `mlx_gpu/mps speedup`: runtime speedup of mlx_gpu compared to mps
* `mlx_gpu/mlx_cpu speedup`: runtime speedup of mlx_gpu compared to mlx_cpu
* `cuda/cpu speedup`: runtime speedup of cuda compared to cpu

## Apple Silicon

**M1 (cores: 4E+4P+8GPU)**

| Operation      | mlx_gpu | mlx_cpu | mps | cpu | mlx_gpu/mps speedup | mlx_gpu/mlx_cpu speedup |
|----------------|-------|-------|------|------|-------------------|-----------------------|
| Argmax     |   1.81 |  10.63 |   2.87 |   8.05 |    +58% |   +486% |
| BCE        |   5.51 |  51.81 |  12.19 |  10.87 |   +121% |   +840% |
| Concat     |  19.13 | 100.88 |  19.28 |  49.63 |     +0% |   +427% |
| Conv1d     |   3.83 |   4.53 |   3.73 | 116.13 |     -2% |    +18% |
| Conv2d     |  30.12 | 436.68 |   7.06 |  45.54 |    -76% |  +1349% |
| LeakyReLU  |   2.06 |   2.90 |   1.16 |   1.37 |    -43% |    +41% |
| Linear     |  30.41 |  73.32 |  53.70 | 117.68 |    +76% |   +141% |
| MatMul     |  26.38 |  93.82 |  47.87 | 504.47 |    +81% |   +255% |
| PReLU      |   3.50 |   4.54 |   1.15 |   1.32 |    -67% |    +29% |
| ReLU       |   0.98 |   0.90 |   1.13 |   1.35 |    +14% |     -8% |
| SeLU       |   7.81 |  14.73 |   1.14 |   7.72 |    -85% |    +88% |
| Sigmoid    |   0.96 |  32.66 |   1.16 |   7.23 |    +19% |  +3287% |
| Softmax    |  10.15 |  40.98 |  19.27 |  46.69 |    +89% |   +303% |
| Softplus   |   1.07 |  33.08 |   1.73 |  10.99 |    +60% |  +2977% |
| Sort       |  18.49 | 713.23 |  73.24 |  70.11 |   +296% |  +3756% |
| Sum        |  11.33 |  12.70 |  16.35 |  13.43 |    +44% |    +12% |
| SumAll     |   6.91 |   6.85 |   7.40 |   7.00 |     +7% |      0% |

**Apple M1 Pro: (2E+8P+16GPU+16GB) - mlx: 0.5.0**

| Operation       | mlx_gpu | mlx_gpu_compile | mlx_cpu | mps | cpu | mlx_gpu_compile/mlx_gpu speedup | mlx_gpu/mps speedup | mlx_gpu/mlx_cpu speedup |
|-----------------|-------|---------------|-------|------|------|-------------------------------|-------------------|-----------------------|
| Argmax      |   1.75 |   1.74 |  10.55 |   1.02 |   8.19 |     +0% |    -41% |   +503% |
| BCE         |   2.18 |   0.97 |  59.50 |   0.84 |   8.48 |   +125% |    -61% |  +2629% |
| Concat      |   6.14 |   6.13 |  87.88 |   6.21 |  36.74 |     +0% |     +1% |  +1332% |
| Conv1d      |   1.76 |   1.64 |   3.42 |   1.01 | 154.38 |     +7% |    -42% |    +94% |
| Conv2d      |   5.71 |   5.67 | 443.83 |   2.52 |  42.12 |     +0% |    -55% |  +7669% |
| Gather      |   3.15 |   3.17 |   4.95 |  18.87 |   9.03 |      0% |   +498% |    +57% |
| LeakyReLU   |   0.46 |   0.44 |   0.80 |   0.47 |   1.21 |     +4% |     +2% |    +74% |
| Linear      |  12.65 |  12.61 |  27.91 |  32.61 | 107.29 |     +0% |   +157% |   +120% |
| MatMul      |  10.52 |  10.65 |  38.29 |  22.76 | 498.70 |     -1% |   +116% |   +263% |
| PReLU       |   0.48 |   0.46 |   3.37 |   0.55 |   1.07 |     +3% |    +15% |   +607% |
| ReLU        |   0.47 |   0.43 |   0.63 |   0.55 |   1.08 |     +9% |    +18% |    +34% |
| Scatter     |   0.59 |   0.57 |  30.02 |   3.38 |   1.94 |     +2% |   +473% |  +5002% |
| ScatterSum  |   0.03 |   0.04 |   0.01 |    nan |   1.47 |    -14% |    nan% |    -71% |
| ScatterMax  |   0.03 |   0.04 |   0.01 |    nan |   1.44 |    -10% |    nan% |    -69% |
| SeLU        |   0.51 |   0.46 |   4.86 |   0.47 |   6.72 |    +12% |     -8% |   +849% |
| Sigmoid     |   0.44 |   0.44 |   4.58 |   0.55 |   6.39 |     +0% |    +23% |   +931% |
| Softmax     |   9.44 |   7.32 |  41.66 |   5.96 |  30.23 |    +28% |    -36% |   +341% |
| Softplus    |   0.46 |   0.49 |  35.26 |   0.49 |   8.97 |     -7% |     +6% |  +7646% |
| Sort        |   1.69 |   1.72 | 258.35 |  37.76 |  58.56 |     -1% |  +2129% | +15156% |
| Sum         |   3.38 |   3.46 |   9.25 |   6.06 |  10.02 |     -2% |    +79% |   +173% |
| SumAll      |   2.52 |   2.63 |   6.83 |   2.48 |   3.46 |     -4% |     -1% |   +171% |

**M1 Max 64GB** mlx 0.2.0

| Operation       | mlx_gpu | mlx_gpu_compile | mlx_cpu | mps | cpu | mlx_gpu_compile/mlx_gpu speedup | mlx_gpu/mps speedup | mlx_gpu/mlx_cpu speedup |
|-----------------|-------|---------------|-------|------|------|-------------------------------|-------------------|-----------------------|
| Argmax      |   2.14 |   1.69 |  10.80 |   1.93 |   9.17 |    +27% |    -10% |   +403% |
| BCE         |   1.30 |   0.65 |  50.27 |   1.01 |   8.09 |    +98% |    -22% |  +3777% |
| Concat      |   3.20 |   3.20 |  92.35 |   3.27 |  24.79 |     +0% |     +2% |  +2782% |
| Conv1d      |   2.20 |   0.98 |   3.34 |   1.18 | 157.26 |   +124% |    -46% |    +51% |
| Conv2d      |   8.18 |   7.24 | 455.47 |   1.98 |  35.56 |    +13% |    -75% |  +5468% |
| Gather      |   2.51 |   2.37 |   5.94 |   9.78 |   8.92 |     +5% |   +289% |   +136% |
| LeakyReLU   |   0.54 |   0.34 |   4.40 |   0.45 |   0.63 |    +59% |    -15% |   +719% |
| Linear      |   6.73 |   6.49 |  32.46 |  16.44 |  39.44 |     +3% |   +144% |   +382% |
| MatMul      |   4.66 |   4.64 |  47.17 |  11.16 |  88.32 |     +0% |   +139% |   +913% |
| PReLU       |   0.82 |   0.36 |   2.64 |   0.44 |   0.57 |   +127% |    -46% |   +222% |
| ReLU        |   0.36 |   0.33 |   0.82 |   0.44 |   0.60 |     +9% |    +21% |   +125% |
| Scatter     |   4.11 |   4.09 |  30.31 |   1.85 |   1.78 |     +0% |    -55% |   +637% |
| ScatterSum  |   0.05 |   0.03 |   0.01 |    nan |   1.35 |    +42% |    nan% |    -81% |
| ScatterMax  |   0.05 |   0.03 |   0.01 |    nan |   1.35 |    +34% |    nan% |    -81% |
| SeLU        |   1.53 |   0.36 |   7.05 |   0.46 |   5.97 |   +323% |    -69% |   +362% |
| Sigmoid     |   0.38 |   0.36 |  32.57 |   0.50 |   5.43 |     +7% |    +30% |  +8409% |
| Softmax     |   4.84 |   3.71 |  43.48 |   3.88 |  28.93 |    +30% |    -19% |   +798% |
| Softplus    |   0.57 |   0.34 |  32.79 |   0.67 |   8.25 |    +65% |    +17% |  +5642% |
| Sort        |   1.08 |   0.97 | 257.18 |  20.18 |  49.30 |    +10% |  +1773% | +23780% |
| Sum         |   1.75 |   1.74 |   8.87 |   3.10 |  10.35 |     +0% |    +77% |   +406% |
| SumAll      |   1.36 |   1.34 |   6.63 |   1.50 |   3.36 |     +1% |    +10% |   +389% |

**M2**

| Operation      | mlx_gpu | mlx_cpu | mps | cpu | mlx_gpu/mps speedup | mlx_gpu/mlx_cpu speedup |
|----------------|-------|-------|------|------|-------------------|-----------------------|
| Argmax     |   1.71 |  16.21 |   2.71 |   8.51 |    +58% |   +849% |
| BCE        |   3.71 |  82.34 |  13.06 |  13.34 |   +251% |  +2118% |
| Concat     |  12.14 | 161.07 |  12.51 |  46.33 |     +3% |  +1226% |
| Conv1d     |   3.66 |   6.01 |   3.29 | 132.69 |    -10% |    +64% |
| Conv2d     |  27.74 | 705.78 |   5.94 |  56.88 |    -78% |  +2444% |
| LeakyReLU  |   1.50 |   2.44 |   1.10 |   1.33 |    -26% |    +62% |
| Linear     |  25.01 |  99.71 |  57.29 | 183.02 |   +129% |   +298% |
| MatMul     |  22.04 | 120.61 |  78.10 | 629.63 |   +254% |   +447% |
| PReLU      |   2.43 |   4.58 |   1.04 |   1.35 |    -57% |    +88% |
| ReLU       |   0.77 |   1.00 |   1.00 |   1.34 |    +30% |    +29% |
| SeLU       |   5.31 |  17.25 |   1.11 |   8.24 |    -79% |   +224% |
| Sigmoid    |   0.77 |  52.85 |   1.13 |   7.47 |    +47% |  +6797% |
| Softmax    |   7.07 |  65.62 |  14.54 |  60.92 |   +105% |   +828% |
| Softplus   |   0.91 |  53.94 |   1.73 |  12.12 |    +90% |  +5846% |
| Sort       |  16.87 | 1243.25 |  46.69 |  79.31 |   +176% |  +7269% |
| Sum        |   9.15 |  18.38 |  10.47 |  14.19 |    +14% |   +100% |
| SumAll     |   4.31 |   7.79 |   4.96 |   6.11 |    +14% |    +80% |

**M2 Pro (cores: 4E+6P+16GPU)**

| Operation      | mlx_gpu | mlx_cpu | mps | cpu | mlx_gpu/mps speedup | mlx_gpu/mlx_cpu speedup |
|----------------|-------|-------|------|------|-------------------|-----------------------|
| Argmax     |   1.10 |  11.84 |   1.47 |   7.78 |    +34% |   +979% |
| BCE        |   2.08 |  47.55 |   7.99 |   7.79 |   +284% |  +2188% |
| Concat     |   6.13 |  92.60 |   6.44 |  39.02 |     +5% |  +1411% |
| Conv1d     |   2.87 |   3.30 |   1.98 | 145.07 |    -30% |    +15% |
| Conv2d     |  14.31 | 401.42 |   4.55 |  43.57 |    -68% |  +2704% |
| LeakyReLU  |   1.01 |   1.95 |   1.01 |   1.22 |      0% |    +93% |
| Linear     |  12.73 |  45.55 |  31.81 | 103.01 |   +149% |   +257% |
| MatMul     |  14.69 |  43.34 |  22.79 | 785.05 |    +55% |   +195% |
| PReLU      |   1.37 |   3.42 |   0.87 |   1.23 |    -35% |   +150% |
| ReLU       |   0.48 |   0.71 |   0.92 |   1.15 |    +89% |    +45% |
| SeLU       |   2.78 |  12.23 |   1.00 |   5.66 |    -63% |   +339% |
| Sigmoid    |   0.79 |  30.60 |   1.09 |   5.23 |    +38% |  +3778% |
| Softmax    |   3.91 |  38.92 |   9.17 |  36.03 |   +134% |   +895% |
| Softplus   |   0.85 |  31.50 |   1.13 |   7.81 |    +32% |  +3588% |
| Sort       |   8.50 | 709.04 |  23.19 |  48.95 |   +173% |  +8245% |
| Sum        |   4.05 |  11.55 |   4.27 |  10.36 |     +5% |   +184% |
| SumAll     |   2.55 |   6.60 |   2.85 |   3.47 |    +11% |   +158% |

**M2 Max (cores: 4E+8P+38GPU)**

| Operation      | mlx_gpu | mlx_cpu | mps | cpu | mlx_gpu/mps speedup | mlx_gpu/mlx_cpu speedup |
|----------------|-------|-------|------|------|-------------------|-----------------------|
| Argmax     |   0.87 |  11.47 |   1.29 |   7.27 |    +47% |  +1213% |
| BCE        |   1.31 |  46.26 |   6.81 |   6.27 |   +417% |  +3420% |
| Concat     |   3.19 |  90.31 |   3.87 |  23.54 |    +21% |  +2728% |
| Conv1d     |   3.88 |   3.24 |   1.49 | 147.63 |    -61% |    -16% |
| Conv2d     |   6.88 | 391.73 |   2.39 |  36.21 |    -65% |  +5595% |
| LeakyReLU  |   0.89 |   1.78 |   0.94 |   0.86 |     +5% |    +99% |
| Linear     |   6.33 |  45.43 |  13.66 |  75.38 |   +115% |   +618% |
| MatMul     |  10.35 |  42.33 |  10.73 | 713.08 |     +3% |   +309% |
| PReLU      |   1.24 |   3.15 |   0.98 |   0.88 |    -21% |   +154% |
| ReLU       |   0.71 |   0.76 |   0.94 |   0.94 |    +32% |     +7% |
| SeLU       |   1.91 |  12.00 |   1.00 |   4.51 |    -47% |   +528% |
| Sigmoid    |   0.47 |  31.06 |   0.74 |   4.46 |    +57% |  +6469% |
| Softmax    |   2.39 |  38.44 |   6.81 |  23.90 |   +184% |  +1506% |
| Softplus   |   0.43 |  31.37 |   0.83 |   6.31 |    +91% |  +7129% |
| Sort       |   3.75 | 699.20 |  10.99 |  41.23 |   +193% | +18550% |
| Sum        |   2.09 |  11.55 |   2.60 |  10.40 |    +24% |   +453% |
| SumAll     |   1.41 |   6.60 |   1.94 |   3.48 |    +38% |   +369% |

**M2 Max (cores: 4E+8P+38GPU)** mlx 0.5.0 torch 2.2.1

| Operation       | mlx_gpu | mlx_gpu_compile | mlx_cpu | mps | cpu | mlx_gpu_compile/mlx_gpu speedup | mlx_gpu/mps speedup | mlx_gpu/mlx_cpu speedup |
|-----------------|-------|---------------|-------|------|------|-------------------------------|-------------------|-----------------------|
| Argmax      |   1.50 |   1.51 |  10.10 |   0.68 |   8.63 |      0% |    -54% |   +571% |
| BCE         |   1.00 |   0.44 |  59.91 |   0.60 |   9.01 |   +126% |    -40% |  +5880% |
| Concat      |   3.18 |   3.16 |  83.04 |   3.34 |  27.24 |     +0% |     +4% |  +2507% |
| Conv1d      |   0.86 |   0.76 |   3.03 |   0.53 | 160.40 |    +13% |    -38% |   +250% |
| Conv2d      |   2.45 |   2.44 | 424.52 |   1.15 |  34.30 |     +0% |    -53% | +17249% |
| Gather      |   1.34 |   1.57 |   3.92 |   8.12 |   8.98 |    -14% |   +504% |   +191% |
| LeakyReLU   |   0.22 |   0.30 |   0.72 |   0.30 |   1.21 |    -24% |    +35% |   +219% |
| Linear      |   5.51 |   5.63 |  23.52 |  12.97 |  37.92 |     -2% |   +135% |   +327% |
| MatMul      |   3.77 |   3.83 |  27.42 |   9.78 |  83.55 |     -1% |   +159% |   +627% |
| PReLU       |   0.28 |   0.48 |   3.27 |   0.42 |   1.03 |    -41% |    +50% |  +1062% |
| ReLU        |   0.37 |   0.24 |   0.62 |   0.35 |   0.94 |    +51% |     -5% |    +67% |
| Scatter     |   0.22 |   0.24 |  28.88 |   1.47 |   1.82 |     -9% |   +567% | +12984% |
| ScatterSum  |   0.03 |   0.03 |   0.01 |    nan |   1.37 |    +10% |    nan% |    -69% |
| ScatterMax  |   0.03 |   0.03 |   0.01 |    nan |   1.39 |    +10% |    nan% |    -68% |
| SeLU        |   0.29 |   0.36 |   4.62 |   0.49 |   7.07 |    -20% |    +69% |  +1511% |
| Sigmoid     |   0.24 |   0.27 |   4.34 |   0.36 |   6.35 |    -10% |    +52% |  +1714% |
| Softmax     |   4.62 |   3.60 |  40.03 |   3.07 |  33.25 |    +28% |    -33% |   +766% |
| Softplus    |   0.25 |   0.24 |  34.73 |   0.33 |   9.39 |     +3% |    +31% | +13696% |
| Sort        |   0.73 |   0.75 | 248.89 |  10.65 |  58.88 |     -2% |  +1360% | +34026% |
| Sum         |   1.61 |   1.64 |   9.22 |   1.96 |  12.05 |     -1% |    +21% |   +472% |
| SumAll      |   1.20 |   1.23 |   6.86 |   1.32 |   3.84 |     -2% |     +9% |   +471% |

**M2 Ultra (cores: 8E+16P+76GPU)** mlx 0.2.0

| Operation  | mlx_gpu | mlx_gpu_compile | mlx_cpu | mps | cpu | mlx_gpu_compile/mlx_gpu speedup | mlx_gpu/mps speedup | mlx_gpu/mlx_cpu speedup |
|------------|-------|---------------|-------|------|------|-------------------------------|-------------------|-----------------------|
| Argmax     |   1.80 |   1.68 |   9.17 |   0.61 |   9.45 |     +7% |    -66% |   +409% |
| BCE        |   0.73 |   0.44 |  44.77 |   0.50 |   3.42 |    +65% |    -32% |  +6027% |
| Concat     |   1.71 |   1.68 |  88.96 |   1.81 |  40.02 |     +1% |     +5% |  +5113% |
| Conv1d     |   2.20 |   0.58 |   2.75 |   0.58 | 169.17 |   +280% |    -73% |    +25% |
| Conv2d     |   5.39 |   4.11 | 378.96 |   0.94 |  37.07 |    +31% |    -82% |  +6932% |
| Gather     |   1.24 |   1.15 |   5.57 |   4.09 |  11.90 |     +7% |   +229% |   +348% |
| LeakyReLU  |   0.42 |   0.39 |   4.01 |   0.54 |   1.09 |     +8% |    +26% |   +847% |
| Linear     |   3.33 |   3.07 |  17.11 |   7.48 |  31.76 |     +8% |   +124% |   +413% |
| MatMul     |   2.63 |   2.62 |  23.09 |   5.97 |  69.41 |     +0% |   +127% |   +778% |
| PReLU      |   0.71 |   0.46 |   2.39 |   0.48 |   1.07 |    +54% |    -32% |   +235% |
| ReLU       |   0.50 |   0.40 |   0.76 |   0.54 |   1.11 |    +26% |     +8% |    +50% |
| Scatter    |   2.13 |   1.81 |  26.53 |   1.09 |   1.28 |    +17% |    -48% |  +1146% |
| ScatterSum |   0.04 |   0.03 |   0.01 |    nan |   1.39 |    +35% |    nan% |    -79% |
| ScatterMax |   0.04 |   0.03 |   0.01 |    nan |   1.39 |    +28% |    nan% |    -79% |
| SeLU       |   1.26 |   0.56 |   8.97 |   0.74 |   3.17 |   +124% |    -41% |   +609% |
| Sigmoid    |   0.54 |   0.83 |  29.18 |   0.60 |   2.61 |    -34% |    +10% |  +5285% |
| Softmax    |   2.63 |   1.93 |  41.16 |   2.37 |  14.95 |    +35% |     -9% |  +1467% |
| Softplus   |   0.57 |   0.35 |  30.11 |   0.60 |   3.46 |    +62% |     +6% |  +5228% |
| Sort       |   0.69 |   0.58 | 226.54 |   6.29 |  22.50 |    +18% |   +811% | +32766% |
| Sum        |   0.92 |   0.90 |   9.04 |   1.39 |   6.18 |     +1% |    +51% |   +883% |
| SumAll     |   0.75 |   0.76 |   6.56 |   1.02 |   1.99 |      0% |    +35% |   +770% |

**M3 (RAM: 16GB)** - mlx 0.2.0

 Average benchmark:
| Operation      | mlx_gpu | mlx_cpu | mps | cpu | mlx_gpu/mps speedup | mlx_gpu/mlx_cpu speedup |
|----------------|-------|-------|------|------|-------------------|-----------------------|
| Argmax     |   1.20 |  11.63 |   1.71 |   7.10 |    +43% |   +870% |
| BCE        |   4.05 |  40.80 |   8.59 |   8.14 |   +111% |   +906% |
| Concat     |  12.52 |  83.29 |  12.60 |  35.29 |     +0% |   +565% |
| Conv1d     |   2.34 |   3.66 |   1.98 |  71.23 |    -15% |    +56% |
| Conv2d     |  16.47 | 340.03 |   4.43 |  36.36 |    -73% |  +1965% |
| LeakyReLU  |   1.43 |   3.05 |   1.01 |   1.07 |    -29% |   +113% |
| Linear     |  21.55 |  71.89 |  15.84 | 122.32 |    -26% |   +233% |
| MatMul     |  15.49 |  76.57 |  33.24 | 490.48 |   +114% |   +394% |
| PReLU      |   2.36 |   2.76 |   0.99 |   1.11 |    -58% |    +16% |
| ReLU       |   0.76 |   1.39 |   0.96 |   1.01 |    +26% |    +81% |
| SeLU       |   5.23 |   7.72 |   1.02 |   6.88 |    -80% |    +47% |
| Sigmoid    |   0.79 |  26.97 |   1.07 |   5.69 |    +35% |  +3309% |
| Softmax    |   6.31 |  41.35 |  12.08 |  32.54 |    +91% |   +555% |
| Softplus   |   0.73 |  26.82 |   1.08 |   9.09 |    +47% |  +3569% |
| Sort       |  12.67 | 724.26 |  30.73 |  60.29 |   +142% |  +5616% |
| Sum        |   6.96 |  11.24 |   6.61 |  12.27 |     -5% |    +61% |
| SumAll     |   4.26 |   7.79 |   4.78 |   4.38 |    +12% |    +82% |

**M3 Pro (cores: 6E+5P+14GPU)**

| Operation      | mlx_gpu | mlx_cpu | mps | cpu | mlx_gpu/mps speedup | mlx_gpu/mlx_cpu speedup |
|----------------|-------|-------|------|------|-------------------|-----------------------|
| Argmax     |   0.98 |  11.21 |   1.24 |   6.14 |    +25% |  +1041% |
| BCE        |   2.70 |  39.88 |   6.87 |   6.78 |   +154% |  +1374% |
| Concat     |   8.25 |  78.33 |   8.87 |  38.10 |     +7% |   +849% |
| Conv1d     |   2.15 |   3.36 |   2.07 |  83.18 |     -3% |    +56% |
| Conv2d     |  12.06 | 333.03 |   3.09 |  33.87 |    -74% |  +2660% |
| LeakyReLU  |   1.54 |   1.53 |   1.26 |   0.96 |    -18% |      0% |
| Linear     |  15.30 |  52.78 |  11.44 |  91.49 |    -25% |   +244% |
| MatMul     |  16.04 |  69.27 |  22.53 | 390.04 |    +40% |   +331% |
| PReLU      |   2.04 |   2.80 |   1.35 |   0.91 |    -34% |    +37% |
| ReLU       |   0.94 |   0.61 |   1.37 |   0.92 |    +45% |    -34% |
| SeLU       |   3.98 |  10.10 |   1.27 |   4.69 |    -68% |   +153% |
| Sigmoid    |   1.03 |  26.28 |   1.30 |   4.28 |    +25% |  +2446% |
| Softmax    |   4.62 |  32.54 |   9.32 |  29.78 |   +101% |   +604% |
| Softplus   |   1.02 |  25.95 |   1.26 |   6.52 |    +23% |  +2444% |
| Sort       |   8.67 | 711.98 |  21.37 |  46.71 |   +146% |  +8114% |
| Sum        |   4.73 |   9.81 |   5.12 |   8.83 |     +8% |   +107% |
| SumAll     |   3.17 |   4.71 |   3.69 |   3.44 |    +16% |    +48% |

**M3 Max (cores: 4E+12P+40GPU)** mlx 0.2.0

| Operation       | mlx_gpu | mlx_gpu_compile | mlx_cpu | mps | cpu | mlx_gpu_compile/mlx_gpu speedup | mlx_gpu/mps speedup | mlx_gpu/mlx_cpu speedup |
|-----------------|-------|---------------|-------|------|------|-------------------------------|-------------------|-----------------------|
| Argmax      |   1.57 |   1.56 |   8.34 |   1.02 |   6.14 |     +0% |    -35% |   +430% |
| BCE         |   1.12 |   0.52 |  38.72 |   0.59 |   3.73 |   +114% |    -47% |  +3362% |
| Concat      |   3.32 |   3.30 |  82.26 |   3.40 |  22.89 |     +0% |     +2% |  +2380% |
| Conv1d      |   0.85 |   0.75 |   2.40 |   0.92 | 156.00 |    +13% |     +8% |   +182% |
| Conv2d      |   4.21 |   4.14 | 329.47 |   1.42 |  31.25 |     +1% |    -66% |  +7723% |
| Gather      |   1.56 |   1.47 |   4.37 |   8.23 |   6.68 |     +5% |   +428% |   +180% |
| LeakyReLU   |   0.43 |   0.29 |   2.57 |   0.54 |   0.66 |    +48% |    +24% |   +491% |
| Linear      |   5.66 |   5.66 |  24.67 |   4.24 |  59.04 |     +0% |    -25% |   +336% |
| MatMul      |   4.20 |   4.19 |  25.57 |   7.62 | 585.74 |     +0% |    +81% |   +508% |
| PReLU       |   0.70 |   0.29 |   2.06 |   0.49 |   0.61 |   +144% |    -29% |   +193% |
| ReLU        |   0.51 |   0.35 |   0.65 |   0.78 |   0.62 |    +45% |    +53% |    +28% |
| Scatter     |   2.29 |   2.22 |  25.40 |   1.66 |   0.93 |     +3% |    -27% |  +1009% |
| ScatterSum  |   0.04 |   0.03 |   0.01 |    nan |   1.22 |    +52% |    nan% |    -81% |
| ScatterMax  |   0.04 |   0.03 |   0.01 |    nan |   1.23 |    +52% |    nan% |    -81% |
| SeLU        |   1.35 |   0.29 |   5.14 |   0.48 |   2.93 |   +361% |    -64% |   +281% |
| Sigmoid     |   0.30 |   0.29 |  26.28 |   0.49 |   2.85 |     +4% |    +62% |  +8629% |
| Softmax     |   4.75 |   3.59 |  35.79 |   3.40 |  16.50 |    +32% |    -28% |   +653% |
| Softplus    |   0.35 |   0.29 |  26.02 |   0.51 |   4.00 |    +21% |    +43% |  +7257% |
| Sort        |   0.77 |   0.76 | 229.39 |   8.04 |  32.43 |     +1% |   +942% | +29646% |
| Sum         |   1.55 |   1.54 |   6.53 |   1.90 |   6.99 |     +0% |    +22% |   +322% |
| SumAll      |   1.19 |   1.19 |   4.78 |   1.32 |   3.22 |     +0% |    +10% |   +300% |


## CUDA GPUs

**Tesla V100 32Go (PCIe) / Intel Xeon Gold 5120 14 cores / 28 threads @ 2.2GHz (Skylake), 60Go**

| Operation       | cpu | cuda | cuda/cpu speedup |
|-----------------|------|------|----------------|
| Argmax      |  34.34 |   0.10 | +33411% |
| BCE         | 198.19 |   0.19 | +102820% |
| Concat      | 380.98 |   1.67 | +22679% |
| Conv1d      |  30.21 |   0.33 |  +9027% |
| Conv2d      |  52.73 |   0.87 |  +5938% |
| Gather      |  96.61 |   0.42 | +22636% |
| LeakyReLU   |   5.51 |   0.08 |  +7010% |
| Linear      | 901.98 |   3.79 | +23722% |
| MatMul      | 1241.12 |   2.80 | +44293% |
| PReLU       |   5.55 |   0.08 |  +7159% |
| ReLU        |   5.50 |   0.08 |  +7032% |
| Scatter     |   6.92 |   0.12 |  +5875% |
| ScatterSum  |   4.25 |   0.08 |  +5058% |
| ScatterMax  |    nan |    nan |    nan% |
| SeLU        |  11.56 |   0.08 | +14709% |
| Sigmoid     |   9.46 |   0.08 | +12023% |
| Softmax     | 221.43 |   0.71 | +31300% |
| Softplus    |  22.13 |   0.08 | +27658% |
| Sort        | 526.33 |   2.59 | +20202% |
| Sum         |  67.43 |   0.70 |  +9472% |
| SumAll      |  29.82 |   0.50 |  +5822% |

**Tesla V100 32Go (NVLink) / Intel Xeon Gold 6148 20 cores, 40 threads @ 2.4 GHz (Skylake), 60Go**

| Operation       | cpu | cuda | cuda/cpu speedup |
|-----------------|------|------|----------------|
| Argmax      |  28.23 |   0.10 | +28460% |
| BCE         | 186.05 |   0.19 | +97956% |
| Concat      | 531.34 |   1.67 | +31744% |
| Conv1d      |  22.37 |   0.31 |  +7033% |
| Conv2d      |  52.89 |   0.83 |  +6257% |
| Gather      | 161.56 |   0.41 | +39152% |
| LeakyReLU   |  16.95 |   0.08 | +21591% |
| Linear      | 666.79 |   3.58 | +18532% |
| MatMul      | 998.29 |   2.68 | +37198% |
| PReLU       |  15.55 |   0.08 | +20584% |
| ReLU        |  14.07 |   0.08 | +18496% |
| Scatter     |   6.19 |   0.11 |  +5548% |
| ScatterSum  |   6.83 |   0.08 |  +8757% |
| ScatterMax  |    nan |    nan |    nan% |
| SeLU        |  20.94 |   0.08 | +27171% |
| Sigmoid     |  19.82 |   0.08 | +25331% |
| Softmax     | 253.76 |   0.70 | +36156% |
| Softplus    |  29.21 |   0.08 | +37131% |
| Sort        | 422.98 |   2.48 | +16933% |
| Sum         |  69.38 |   0.70 |  +9861% |
| SumAll      |  31.13 |   0.50 |  +6152% |

**RTX4090 (Desktop) / 10th Gen Intel Core i9-10940X @ 3.30GHz 128GB**

| Operation       | cpu | cuda | cuda/cpu speedup |
|-----------------|------|------|----------------|
| Argmax      |   6.67 |   0.04 | +14782% |
| BCE         |  23.74 |   0.14 | +16992% |
| Concat      |  52.08 |   1.29 |  +3922% |
| Conv1d      |   2.84 |   0.15 |  +1753% |
| Conv2d      |   6.60 |   0.25 |  +2559% |
| Gather      |  19.75 |   0.27 |  +7340% |
| LeakyReLU   |   2.44 |   0.03 |  +7439% |
| Linear      |  62.27 |   1.01 |  +6057% |
| MatMul      |  87.47 |   1.36 |  +6322% |
| PReLU       |   2.28 |   0.04 |  +5297% |
| ReLU        |   2.47 |   0.03 |  +7216% |
| Scatter     |   1.84 |   0.07 |  +2652% |
| ScatterSum  |   3.86 |   0.06 |  +5919% |
| ScatterMax  |   3.86 |   0.08 |  +4790% |
| SeLU        |   2.71 |   0.04 |  +6952% |
| Sigmoid     |   2.63 |   0.05 |  +5626% |
| Softmax     |  27.75 |   0.59 |  +4634% |
| Softplus    |   3.50 |   0.04 |  +8149% |
| Sort        |  46.67 |   0.90 |  +5077% |
| Sum         |  12.19 |   0.62 |  +1866% |
| SumAll      |   6.95 |   0.45 |  +1428% |
